"use strict";!function(){var e=(angular.module("sg-utils-iso3166",[]),angular.module("sg-utils-iso4217",[]),angular.module("sg-utils-ubigeo",[])),i=(angular.module("sg-utils-persona",[]),angular.module("sg-utils-organizacion",[]),angular.module("sg-utils-cooperativa",[])),t=(angular.module("sg-utils-producto",[]),angular.module("sg-utils-rrhh",[])),n=angular.module("sg-utils",["sg-utils-iso3166","sg-utils-iso4217","sg-utils-ubigeo","sg-utils-persona","sg-utils-organizacion","sg-utils-cooperativa","sg-utils-producto","sg-utils-rrhh"]);n.filter("si_no",function(){return function(e,i){var t=["Si","No"],n=["Activo","Inactivo"],a=["Abierto","Cerrado"],o=["Descongelado","Congelado"],r=t;return i&&(r="si"==i.toLowerCase()?t:"activo"==i.toLowerCase()?n:"abierto"==i.toLowerCase()?a:"congelado"==i.toLowerCase()?o:t),e?r[0]:r[1]}}),n.directive("sgMaxDate",function(){return{require:"ngModel",link:function(e,i,t,n){n.$validators.sgmaxdate=function(i,t){var n=i||t;return e.maxDate>=n}}}}),n.service("SGDialog",["$modal",function(e){var i={},t=function(i,t,n){var a=function(e,i,t,n,a){e.title=t,e.message=n,e.btns=a,e.ok=function(){i.close()},e.cancel=function(){i.dismiss("cancel")}};return a.$inject=["$scope","$modalInstance","title","message","btns"],e.open({template:'<div class="modal-header">\n<button type="button" class="close" ng-click="cancel()">\n<span class="pficon pficon-close"></span>\n</button>\n<h4 class="modal-title">{{title}}</h4>\n</div>\n<div class="modal-body">{{message}}</div>\n<div class="modal-footer">\n<button type="button" data-ng-class="btns.cancel.cssClass" ng-click="cancel()">{{btns.cancel.label}}</button>\n<button type="button" data-ng-class="btns.ok.cssClass" ng-click="ok()">{{btns.ok.label}}</button>\n</div>\n',controller:a,resolve:{title:function(){return i},message:function(){return t},btns:function(){return n}}}).result},n=function(e){var i=document.createElement("div");return i.appendChild(document.createTextNode(e)),i.innerHTML};return i.confirmDelete=function(e,i,a){var o="Eliminar "+n(i.charAt(0).toUpperCase()+i.slice(1)),r="�Estas seguro de querer eliminar permanentemente el/la "+i+" "+e+"?",s={ok:{label:"Eliminar",cssClass:"btn btn-danger"},cancel:{label:"Cancelar",cssClass:"btn btn-default"}};t(o,r,s).then(a)},i.confirmGenerateKeys=function(e,i,n){var a="Generate new keys for realm",o="Are you sure you want to permanently generate new keys for "+e+"?",r={ok:{label:"Generate Keys",cssClass:"btn btn-danger"},cancel:{label:"Cancel",cssClass:"btn btn-default"}};t(a,o,r).then(n)},i.confirm=function(e,i,n,a){var o={ok:{label:e,cssClass:"btn btn-danger"},cancel:{label:"Cancel",cssClass:"btn btn-default"}};t(e,i,o).then(n,a)},i}]),n.directive("sgReadOnly",function(){var e={},i={replace:!1,link:function(i,t,n){var a=function(i,t){t.disabled||(e[t.tagName+i]=!0,t.disabled=!0)},o=function(i,t){e[t.tagName+i]&&(t.disabled=!1,delete e[i])};i.$watch(n.sgReadOnly,function(e){e?(t.find("input").each(a),t.find("button").each(a),t.find("select").each(a),t.find("textarea").each(a)):(t.find("input").each(o),t.find("input").each(o),t.find("button").each(o),t.find("select").each(o),t.find("textarea").each(o))})}};return i}),n.directive("sgInput",function(){var e={scope:!0,replace:!1,link:function(e,i,t){var n=i.children("form"),a=i.children("label"),o=i.children("input"),r=n.attr("name")+"."+o.attr("name");i.attr("class","control-group"),a.attr("class","control-label"),a.attr("for",r),o.wrap('<div class="controls"/>'),o.attr("id",r),o.attr("placeHolder")||o.attr("placeHolder",a.text()),o.attr("required")&&a.append(' <span class="required">*</span>')}};return e}),n.directive("sgEnter",function(){return function(e,i,t){i.bind("keydown keypress",function(i){13===i.which&&(e.$apply(function(){e.$eval(t.sgEnter)}),i.preventDefault())})}}),n.directive("sgSave",["$compile",function(e){return{restrict:"A",link:function(e,i,t,n){i.addClass("btn btn-primary"),i.attr('type","submit'),i.bind("click",function(){e.$apply(function(){var t=i.closest("form");if(t&&t.attr("name")){var n=t.find(".ng-valid");if(e[t.attr("name")].$valid)n.parent().removeClass("has-error"),e.save();else{console.log("Missing or invalid field(s). Please verify the fields in red."),n.parent().removeClass("has-error");var a=t.find(".ng-invalid");a.parent().addClass("has-error")}}})})}}}]),n.directive("sgReset",["$compile",function(e){return{restrict:"A",link:function(e,i,t,n){i.addClass("btn btn-default"),i.attr("type","submit"),i.bind("click",function(){e.$apply(function(){var t=i.closest("form");t&&t.attr("name")&&(t.find(".ng-valid").removeClass("error"),t.find(".ng-invalid").removeClass("error"),e.reset())})})}}}]),n.directive("sgCancel",["$compile",function(e){return{restrict:"A",link:function(e,i,t,n){i.addClass("btn btn-default"),i.attr("type","submit")}}}]),n.directive("sgDelete",["$compile",function(e){return{restrict:"A",link:function(e,i,t,n){i.addClass("btn btn-danger"),i.attr("type","submit")}}}]),n.filter("remove",function(){return function(e,i,t){if(!e||!i)return e;for(var n=[],a=0;a<e.length;a++){var o=e[a];if(Array.isArray(i)){for(var r=0;r<i.length;r++)if(t){if(i[r][t]==o[t]){o=null;break}}else if(i[r]==o){o=null;break}}else t?i[t]==o[t]&&(o=null):i==o&&(o=null);null!=o&&n.push(o)}return n}}),n.filter("capitalize",function(){return function(e){if(e){for(var i=e.substring(0,1).toUpperCase(),t=e.substring(1),n=0;n<t.length;n++){var a=t[n];a.match(/[A-Z]/)&&(i=i.concat(" ")),i=i.concat(a)}return i}}}),e.directive("sgUbigeo",["SGUbigeo",function(e){return{restrict:"E",replace:!1,require:["^form","ngModel"],link:function(i,t,n,a){a[1].$validators.sgubigeo=function(e,t){var n=e||t;return n=n?n:"",i.requerido?6==n.length:6==n.length||0==n.length},e.$search().then(function(e){i.departamentos=e,i.activeListener()}),i.provincias=void 0,i.distritos=void 0,i.ubigeo={departamento:void 0,provincia:void 0,distrito:void 0},i.$watch("ubigeo.departamento",function(){!angular.isUndefined(i.ubigeo.departamento)&&i.ubigeo.departamento?(i.provincias=i.ubigeo.departamento.$getProvincias().$object,a[0].$setDirty()):(i.ubigeo.provincia=void 0,i.ubigeo.distrito=void 0,i.provincias=void 0,i.distritos=void 0)}),i.$watch("ubigeo.provincia",function(){!angular.isUndefined(i.ubigeo.provincia)&&i.ubigeo.provincia?i.distritos=e.$getDistritos(i.ubigeo.departamento.ubigeoDepartamento,i.ubigeo.provincia.ubigeoProvincia).$object:(i.ubigeo.distrito=void 0,i.distritos=void 0)}),i.$watch("ubigeo.distrito",function(){if(!angular.isUndefined(i.ubigeo.distrito)&&i.ubigeo.distrito){var e=i.ubigeo.distrito.ubigeo;a[1].$setViewValue(e)}}),i.activeListener=function(){var t=i.$watch(function(){return a[1].$modelValue},function(){if(a[1].$modelValue&&6==a[1].$modelValue.length&&angular.isUndefined(i.provincias)&&angular.isUndefined(i.distritos)){for(var n=0;n<i.departamentos.length;n++)if(i.departamentos[n].ubigeoDepartamento==a[1].$modelValue.substring(0,2)){i.ubigeo.departamento=i.departamentos[n];break}i.ubigeo.departamento.$getProvincias().then(function(t){i.provincias=t;for(var n=0;n<i.provincias.length;n++)if(i.provincias[n].ubigeoProvincia==a[1].$modelValue.substring(2,4)){i.ubigeo.provincia=i.provincias[n];break}e.$getDistritos(i.ubigeo.departamento.ubigeoDepartamento,i.ubigeo.provincia.ubigeoProvincia).then(function(e){i.distritos=e;for(var t=0;t<i.distritos.length;t++)if(i.distritos[t].ubigeoDistrito==a[1].$modelValue.substring(4,6)){i.ubigeo.distrito=i.distritos[t];break}})}),t()}else t()})}},scope:{requerido:"@"},template:'<div class="row"><div class="col-sm-4"><div class="form-group" ng-class="{ \'has-error\' : formSgUbigeo.departamento.$invalid && (formSgUbigeo.departamento.$touched || formSgUbigeo.$submitted)}"><label>Departamento</label><ui-select name="departamento" ng-model="ubigeo.departamento"><ui-select-match placeholder="Seleccione">{{$select.selected.denominacion}}</ui-select-match><ui-select-choices repeat="item in departamentos | filter: $select.search"><div ng-bind-html="item.denominacion | highlight: $select.search"></div><small ng-bind-html="item.codigo | highlight: $select.search"></small></ui-select-choices></ui-select><div ng-messages="formSgUbigeo.departamento.$error" ng-if="formSgUbigeo.departamento.$touched || formSgUbigeo.$submitted"><div class="help-block" ng-message="required">Ingrese departamento.</div></div></div></div><div class="col-sm-4"><div class="form-group" ng-class="{ \'has-error\' : formSgUbigeo.provincia.$invalid && (formSgUbigeo.provincia.$touched || formSgUbigeo.$submitted)}"><label>Provincia</label><ui-select name="provincia" ng-model="ubigeo.provincia"><ui-select-match placeholder="Seleccione">{{$select.selected.denominacion}}</ui-select-match><ui-select-choices repeat="item in provincias | filter: $select.search"><div ng-bind-html="item.denominacion | highlight: $select.search"></div><small ng-bind-html="item.codigo | highlight: $select.search"></small></ui-select-choices></ui-select><div ng-messages="formSgUbigeo.provincia.$error" ng-if="formSgUbigeo.provincia.$touched || formSgUbigeo.$submitted"><div class="help-block" ng-message="required">Ingrese provincia.</div></div></div></div><div class="col-sm-4"><div class="form-group" ng-class="{ \'has-error\' : formSgUbigeo.provincia.$invalid && (formSgUbigeo.provincia.$touched || formSgUbigeo.$submitted)}"><label>Distrito</label><ui-select name="distrito" ng-model="ubigeo.distrito"><ui-select-match placeholder="Seleccione">{{$select.selected.denominacion}}</ui-select-match><ui-select-choices repeat="item in distritos | filter: $select.search"><div ng-bind-html="item.denominacion | highlight: $select.search"></div><small ng-bind-html="item.codigo | highlight: $select.search"></small></ui-select-choices></ui-select><div ng-messages="formSgUbigeo.distrito.$error" ng-if="formSgUbigeo.distrito.$touched || formSgUbigeo.$submitted"><div class="help-block" ng-message="required">Ingrese provincia.</div></div></div></div></div>'}}]),i.directive("sgMonedaBovedaAgenciaValidate",["$q","SGBoveda",function(e,i){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){e.agencia,n.$observe("sgAgencia",function(i){i&&(a.$setViewValue(null),a.$render()),e.agencia=e.$eval(i)}),a.$validators.disponible=function(t,n){var o=t||n,r=void 0;return e.agencia&&(r=e.agencia.codigo,i.$search({agencia:r}).then(function(e){for(var i=!0,t=0;t<e.length;t++)e[t].moneda==o.alphabeticCode&&(i=!1);a.$setValidity("disponible",i)},function(){a.$setValidity("disponible",!1)})),!0}}}}]),t.directive("sgDenominacionSucursalValidate",["$q","SGSucursal",function(e,i){return{restrict:"AE",require:"ngModel",scope:{sgExclude:"=sgExclude"},link:function(t,n,a,o){t.$eval(a.sgSelfInclude);o.$asyncValidators.disponible=function(n,a){var o=n||a;return i.$find(o).then(function(i){return angular.isDefined(i)?t.sgExclude&&i.id==t.sgExclude.id?!0:e.reject("Denominacion de sucursal no disponible"):!0},function(i){return e.reject("Error al buscar sucursal")})}}}}]),t.directive("sgCodigoAgenciaValidate",["$q","SGAgencia",function(e,i){return{restrict:"AE",require:"ngModel",link:function(t,n,a,o){o.$asyncValidators.disponible=function(t,n){var a=t||n;return i.$findByCodigo(a).then(function(i){return i?e.reject("Codigo de agencia no disponible"):!0},function(i){return e.reject("Error")})}}}}]),angular.module("sgtemplate/modal/modal.html",[]).run(["$templateCache",function(e){e.put("sgtemplate/modal/modal.html",'<div class="modal-header">\n<button type="button" class="close" ng-click="cancel()">\n<span class="pficon pficon-close">�</span>\n</button>\n<h4 class="modal-title">{{title}}</h4>\n</div>\n<div class="modal-body">{{message}}</div>\n<div class="modal-footer">\n<button type="button" data-ng-class="btns.cancel.cssClass" ng-click="cancel()">{{btns.cancel.label}}</button>\n<button type="button" data-ng-class="btns.ok.cssClass" ng-click="ok()">{{btns.ok.label}}</button>\n</div>\n')}])}();